<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>100 Days of Code - Day 5</title>
    <meta name="Description" content="Day 5!">
    <link rel="stylesheet" href="/blog/css/index.css">
    <link rel="stylesheet" href="/blog/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/blog/feed/feed.xml" type="application/atom+xml" title="Dev Blog">
  </head>
  <body>
    <header>
      <h1 class="home"><a href="/blog/">Dev Blog</a></h1>
      <ul class="nav">
        <li class="nav-item"><a href="/blog/">Home</a></li>
        <li class="nav-item"><a href="/blog/posts/">Archive</a></li>
        <li class="nav-item"><a href="/blog/about/">About Me</a></li>
      </ul>
    </header>

    <main class="tmpl-post">

      <h1>100 Days of Code - Day 5</h1>

<h3 id="day-5%3A-may-16%2C-2020">Day 5: May 16, 2020 <a class="direct-link" href="#day-5%3A-may-16%2C-2020">#</a></h3>
<h4 id="today's-progress">Today's Progress <a class="direct-link" href="#today's-progress">#</a></h4>
<p>Today I continued through <a href="https://frontendmasters.com/courses/functional-javascript-v3/">Functional-Light JavaScript</a> and covered transduction and generic data structure operations.</p>
<h4 id="thoughts">Thoughts <a class="direct-link" href="#thoughts">#</a></h4>
<p>Transduction is every bit as complicated as I was expecting. I'm going to have to revisit the topic and code up my own example to better understand what's going on.</p>
<p>On a personal note, sticking to 100DaysOfCode on the weekend is much harder when you aren't in the workday rhythm. I'm someone who <em>needs</em> routine to stay on track so I'm going to need to create a weekend coding routine to be successful.</p>
<h4 id="work-examples">Work examples <a class="direct-link" href="#work-examples">#</a></h4>
<h5 id="transduction">Transduction <a class="direct-link" href="#transduction">#</a></h5>
<p>Transduction is the process of composing <code>map()</code>, <code>filter()</code>, and/or <code>reduce()</code>.</p>
<p>We can't do a basic composition of <code>map</code>, <code>filter</code>, and <code>reduce</code> because each of those functions have a different shape (<em>function shape</em>: the number and kinds of things you pass into it as well as the number and kinds of things that come out of it). <code>map</code>'s shape is one value in, one value out. <code>filter</code>'s shape is single value in, boolean value out. <code>reduce</code> takes two inputs, an accumulator and current value.</p>
<p>The plus side of transduction is we don't necessarily need to know what's going on behind the scenes with transduction to use it to our advantage. If we need to compose a <code>map()</code>, <code>filter()</code>, and/or <code>reduce()</code>, then we know we can use <code>transduce()</code>.</p>
<p>Transduction reshapes <code>map()</code> and <code>filter</code> into the shape of reduce so we can compose them together. The reduce versions of <code>map()</code> and <code>filter()</code> are a bit different than the <code>reduce()</code> we're used to - it's actually a higher order reducer (a reducer function that takes a reducer function as a parameter).</p>
<p>Here's transduction in code:</p>
<pre class="language-js"><code class="language-js"><span class="token string">'use strict'</span><span class="token punctuation">;</span><br><br><span class="token keyword">function</span> <span class="token function">divBy</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> num <span class="token operator">/</span> v<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">function</span> <span class="token function">mulBy</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> num <span class="token operator">*</span> v<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">function</span> <span class="token function">addBy</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> num <span class="token operator">+</span> v<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">total<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> total <span class="token operator">+</span> v<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">function</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>fns</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">composed</span><span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> fns<span class="token punctuation">.</span><span class="token function">reduceRight</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">result<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">fn</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token keyword">function</span> <span class="token function">isOdd</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> v <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">var</span> div3 <span class="token operator">=</span> <span class="token function">divBy</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> mul2 <span class="token operator">=</span> <span class="token function">mulBy</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> add1 <span class="token operator">=</span> <span class="token function">addBy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">var</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br><br><span class="token comment">// we'd like to compose these together but we can't with our existing compose function</span><br><span class="token keyword">var</span> result <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>add1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>isOdd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// console.log(result); // 42</span><br><br><span class="token comment">// manual transduction</span><br><br><span class="token keyword">var</span> manualResult <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">allAtOnce</span><span class="token punctuation">(</span><span class="token parameter">total<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  v <span class="token operator">=</span> <span class="token function">add1</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isOdd</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    total <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br>  <span class="token keyword">return</span> total<span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>manualResult<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 42</span><br><br><span class="token comment">// naive (maybe?) implementations of map() and filter() with a reducer</span><br><br><span class="token comment">// mapWithReduce mutates the arr parameter which would normally be a no no</span><br><span class="token comment">// but we can do it because it ultimately doesn't matter with transduction.</span><br><span class="token comment">// The math behind transduction makes the mutation not matter (1) and (2)</span><br><span class="token comment">// transduction is all about performance and creating a new array and appending</span><br><span class="token comment">// values wouldn't be as performant.</span><br><br><span class="token keyword">function</span> <span class="token function">mapWithReduce</span><span class="token punctuation">(</span><span class="token parameter">arr<span class="token punctuation">,</span> mappingFn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span><span class="token parameter">list<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">mappingFn</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//mutation</span><br>    <span class="token keyword">return</span> list<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token keyword">function</span> <span class="token function">filterWithReduce</span><span class="token punctuation">(</span><span class="token parameter">arr<span class="token punctuation">,</span> predicateFn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span><span class="token parameter">list<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">predicateFn</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">return</span> list<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token comment">// If we used a FP lib, mapReducer() and filterReducer() would be provided.</span><br><span class="token comment">// mapReducer() reshapes the mapper to be a reducer.</span><br><span class="token comment">// filterReducer() reshapes filter to be a reducer.</span><br><span class="token comment">// The result of these is a special reducer.</span><br><span class="token comment">// This special reducer needs a reducer to be passed to it in order to become a reducer</span><br><br><span class="token comment">// transducer will become a reducer if passed a reducer</span><br><span class="token keyword">var</span> transducer <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">(</span><br>  <span class="token function">mapReducer</span><span class="token punctuation">(</span>add1<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">filterReducer</span><span class="token punctuation">(</span>isOdd<span class="token punctuation">)</span><br><span class="token punctuation">)</span><br><br><span class="token comment">// transduce() would be provided by a functional lib</span><br><span class="token comment">// Behind the scenes, transduce passes sum into transducer as a reducer, producing a composed reducer</span><br><span class="token comment">// it then reduces the list with the new reducer</span><br><span class="token function">transduce</span><span class="token punctuation">(</span><br>  transducer<span class="token punctuation">,</span><br>  sum<span class="token punctuation">,</span> <span class="token comment">// reducer</span><br>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// initial value</span><br>  <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">]</span> <span class="token comment">// data passed in</span><br><span class="token punctuation">)</span><br><br><span class="token comment">// into is another helper that is usually provided by FP libs</span><br><span class="token comment">// into automatically provides us the sum function from earlier</span><br><span class="token comment">// into looks at the initial data value and implies the combinator to use.</span><br><span class="token comment">// If we passed in a string, into would've done string concatenation.</span><br><span class="token comment">// If passed an array, would do an array push combinator</span><br><br><span class="token function">into</span><span class="token punctuation">(</span>transducer<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>


<p><a href="/blog/">← Home</a></p>

    </main>

    <footer></footer>

    <!-- Current page: /blog/posts/may-16-2020/ -->
  </body>
</html>
