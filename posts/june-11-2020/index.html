<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>100 Days of Code - Day 28</title>
    <meta name="Description" content="Vue + D3">
    <link rel="stylesheet" href="/blog/css/index.css">
    <link rel="stylesheet" href="/blog/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/blog/feed/feed.xml" type="application/atom+xml" title="Dev Blog">
  </head>
  <body>
    <header>
      <h1 class="home"><a href="/blog/">Dev Blog</a></h1>
      <ul class="nav">
        <li class="nav-item"><a href="/blog/">Home</a></li>
        <li class="nav-item"><a href="/blog/posts/">Archive</a></li>
        <li class="nav-item"><a href="/blog/about/">About Me</a></li>
      </ul>
    </header>

    <main class="tmpl-post">

      <h1>100 Days of Code - Day 28</h1>

<h3 id="day-28%3A-june-11%2C-2020">Day 28: June 11, 2020 <a class="direct-link" href="#day-28%3A-june-11%2C-2020">#</a></h3>
<h4 id="today's-progress">Today's Progress <a class="direct-link" href="#today's-progress">#</a></h4>
<p>Today I continued integrating <a href="https://github.com/chrisvaillancourt/vue-d3">D3 with Vue</a>.</p>
<h4 id="thoughts">Thoughts <a class="direct-link" href="#thoughts">#</a></h4>
<p>My head was all over the place so I know this code is far from acceptable but it works and I'm starting to get a better understanding of what goes where. The one issue I'm facing is properly positioning the tooltip. I wish there were more examples of using D3 with Vue but I've found Shirley's <a href="https://github.com/sxywu/vue-d3-example">example</a> invaluable.</p>
<h4 id="work-examples">Work examples <a class="direct-link" href="#work-examples">#</a></h4>
<p>Current component state:</p>
<pre><code>&lt;template&gt;
  &lt;div id=&quot;wrapper&quot; class=&quot;wrapper&quot;&gt;
    &lt;div
      :style=&quot;tooltip.styleObj&quot;
      v-show=&quot;tooltip.display&quot;
      id=&quot;tooltip&quot;
      class=&quot;tooltip&quot;
    &gt;
      &lt;div class=&quot;tooltip-range&quot;&gt;
        Humidity: &lt;span id=&quot;range&quot;&gt;&lt;/span&gt;
      &lt;/div&gt;
      &lt;div class=&quot;tooltip-value&quot;&gt;
        &lt;span id=&quot;count&quot;&gt;&lt;/span&gt; days
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;svg
      class=&quot;histogram&quot;
      :height=&quot;dimensions.height&quot;
      :width=&quot;dimensions.width&quot;
    &gt;
      &lt;g
        class=&quot;bounds&quot;
        :transform=&quot;
          `translate(${dimensions.margin.left}, ${dimensions.margin.top})`
        &quot;
      &gt;
        &lt;g class=&quot;bins&quot;&gt;
          &lt;g v-for=&quot;d in bars&quot; :key=&quot;d.id&quot; class=&quot;bin&quot;&gt;
            &lt;rect
              v-on=&quot;{
                mouseenter: handleMouseEnter,
                mouseleave: handleMouseLeave,
              }&quot;
              :x=&quot;d.x&quot;
              :y=&quot;d.y&quot;
              :height=&quot;d.height&quot;
              :width=&quot;d.width&quot;
              :data-tooltip-range=&quot;d.tooltipRange&quot;
              :data-tooltip-frequency=&quot;d.frequency&quot;
            &gt;&lt;/rect&gt;
            &lt;text :x=&quot;d.label.x&quot; :y=&quot;d.label.y&quot;&gt;&lt;/text&gt;
          &lt;/g&gt;
        &lt;/g&gt;
        &lt;line
          :x1=&quot;line.x&quot;
          :x2=&quot;line.x&quot;
          :y1=&quot;line.y1&quot;
          :y2=&quot;line.y2&quot;
          stroke=&quot;maroon&quot;
          stroke-dasharray=&quot;2px 4px&quot;
        &gt;&lt;/line&gt;
        &lt;text class=&quot;mean-text&quot; :x=&quot;line.x&quot; y=&quot;&quot;&gt;mean&lt;/text&gt;
        &lt;g
          ref=&quot;xAxis&quot;
          class=&quot;x-axis&quot;
          :transform=&quot;`translate(0,${dimensions.boundedHeight})`&quot;
        &gt;
          &lt;text
            class=&quot;x-axis-label&quot;
            :x=&quot;dimensions.boundedWidth / 2&quot;
            :y=&quot;dimensions.margin.bottom - 10&quot;
          &gt;
            Humidity
          &lt;/text&gt;
        &lt;/g&gt;
      &lt;/g&gt;
    &lt;/svg&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> json <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'d3-fetch'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> select <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'d3-selection'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> scaleLinear <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'d3-scale'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> extent<span class="token punctuation">,</span> max<span class="token punctuation">,</span> histogram<span class="token punctuation">,</span> mean <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'d3-array'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> axisBottom <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'d3-axis'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> format <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'d3-format'</span><span class="token punctuation">;</span><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><br>  name<span class="token operator">:</span> <span class="token string">'BarChart'</span><span class="token punctuation">,</span><br>  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token punctuation">{</span><br>      dimensions<span class="token operator">:</span> <span class="token punctuation">{</span><br>        margin<span class="token operator">:</span> <span class="token punctuation">{</span><br>          top<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span><br>          right<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span><br>          bottom<span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span><br>          left<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span><br>        <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        width<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>        boundedWidth<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>        height<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>        boundedHeight<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      <span class="token punctuation">}</span><span class="token punctuation">,</span><br>      weatherData<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token function-variable function">xScale</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>      <span class="token function-variable function">yScale</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>      formatMetric<span class="token operator">:</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'.2f'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>      bars<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>      tooltip<span class="token operator">:</span> <span class="token punctuation">{</span><br>        display<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><br>        range<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>        frequency<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>        styleObj<span class="token operator">:</span> <span class="token punctuation">{</span><br>          transform<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span><br>        <span class="token punctuation">}</span><span class="token punctuation">,</span><br>      <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token function">beforeMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateDimensions</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>      newHeight<span class="token operator">:</span> window<span class="token punctuation">.</span>innerHeight <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">,</span><br>      newWidth<span class="token operator">:</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleResize<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token function">destroyed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleResize<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    console<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  computed<span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token function-variable function">dataMean</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">return</span> <span class="token function">mean</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>weatherData<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>metricAccessor<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token function-variable function">line</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">return</span> <span class="token punctuation">{</span><br>        x<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">xScale</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataMean<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">,</span><br>        y1<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span><br>        y2<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dimensions<span class="token punctuation">.</span>boundedHeight<span class="token punctuation">,</span><br>      <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  watch<span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token function-variable function">weatherData</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">calculateScales</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderAxis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  methods<span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token function">updateDimensions</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> newHeight<span class="token punctuation">,</span> newWidth <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>dimensions<span class="token punctuation">.</span>width <span class="token operator">=</span> newWidth<span class="token punctuation">;</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>dimensions<span class="token punctuation">.</span>height <span class="token operator">=</span> newHeight<span class="token punctuation">;</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>dimensions<span class="token punctuation">.</span>boundedWidth <span class="token operator">=</span><br>        newWidth <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dimensions<span class="token punctuation">.</span>margin<span class="token punctuation">.</span>left <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dimensions<span class="token punctuation">.</span>margin<span class="token punctuation">.</span>right<span class="token punctuation">;</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>dimensions<span class="token punctuation">.</span>boundedHeight <span class="token operator">=</span><br>        newHeight <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dimensions<span class="token punctuation">.</span>margin<span class="token punctuation">.</span>top <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dimensions<span class="token punctuation">.</span>margin<span class="token punctuation">.</span>bottom<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token function">handleResize</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateDimensions</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>        newHeight<span class="token operator">:</span> window<span class="token punctuation">.</span>innerHeight <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">,</span><br>        newWidth<span class="token operator">:</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">,</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token keyword">async</span> <span class="token function">loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>weatherData <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">json</span><span class="token punctuation">(</span><span class="token string">'./static/data/nyc_weather_data.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token function">metricAccessor</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">return</span> d<span class="token punctuation">.</span>humidity<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token function">yAccessor</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token comment">// length of the bins == number of values in that group (frequency)</span><br>      <span class="token keyword">return</span> d<span class="token punctuation">.</span>length<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token function">calculateScales</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>weatherData<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><br><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>xScale <span class="token operator">=</span> <span class="token function">scaleLinear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token function">extent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>weatherData<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>metricAccessor<span class="token punctuation">)</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dimensions<span class="token punctuation">.</span>boundedWidth<span class="token punctuation">]</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">nice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">var</span> binsGenerator <span class="token operator">=</span> <span class="token function">histogram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>xScale<span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>metricAccessor<span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">thresholds</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>      <span class="token keyword">var</span> bins <span class="token operator">=</span> <span class="token function">binsGenerator</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>weatherData<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">d</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        <span class="token comment">// only include bins with a frequency > 0</span><br>        <span class="token keyword">return</span> d<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>yScale <span class="token operator">=</span> <span class="token function">scaleLinear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>bins<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>yAccessor<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>dimensions<span class="token punctuation">.</span>boundedHeight<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">nice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">var</span> barPadding <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>      <span class="token comment">// create bars</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>bars <span class="token operator">=</span> bins<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">d<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        <span class="token keyword">var</span> <span class="token punctuation">{</span> x0<span class="token punctuation">,</span> x1 <span class="token punctuation">}</span> <span class="token operator">=</span> d<span class="token punctuation">;</span><br>        <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">xScale</span><span class="token punctuation">(</span>x0<span class="token punctuation">)</span> <span class="token operator">+</span> barPadding<span class="token punctuation">;</span><br>        <span class="token keyword">var</span> labelX <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">xScale</span><span class="token punctuation">(</span>x0<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">xScale</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">xScale</span><span class="token punctuation">(</span>x0<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> labelY <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">yScale</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">yAccessor</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">yScale</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">yAccessor</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> height <span class="token operator">=</span><br>          <span class="token keyword">this</span><span class="token punctuation">.</span>dimensions<span class="token punctuation">.</span>boundedHeight <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">yScale</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">yAccessor</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> width <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">xScale</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">xScale</span><span class="token punctuation">(</span>x0<span class="token punctuation">)</span> <span class="token operator">-</span> barPadding<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> frequency <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">yAccessor</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> tooltipRange <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">formatMetric</span><span class="token punctuation">(</span>x0<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">formatMetric</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><br>          <span class="token string">'-'</span><br>        <span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">return</span> <span class="token punctuation">{</span><br>          x<span class="token punctuation">,</span><br>          y<span class="token punctuation">,</span><br>          height<span class="token punctuation">,</span><br>          width<span class="token punctuation">,</span><br>          id<span class="token operator">:</span> i<span class="token punctuation">,</span><br>          tooltipRange<span class="token punctuation">,</span><br>          frequency<span class="token punctuation">,</span><br>          label<span class="token operator">:</span> <span class="token punctuation">{</span><br>            x<span class="token operator">:</span> labelX<span class="token punctuation">,</span><br>            y<span class="token operator">:</span> labelY<span class="token punctuation">,</span><br>            text<span class="token operator">:</span> frequency<span class="token punctuation">,</span><br>          <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">}</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token function">renderAxis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">var</span> xAxisGenerator <span class="token operator">=</span> <span class="token function">axisBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>xScale<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token function">select</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>xAxis<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>xAxisGenerator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token function">handleMouseEnter</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">var</span> <span class="token punctuation">{</span> target <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">;</span><br><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>tooltip<span class="token punctuation">.</span>frequency <span class="token operator">=</span> target<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>tooltipFrequency<span class="token punctuation">;</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>tooltip<span class="token punctuation">.</span>range <span class="token operator">=</span> target<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>tooltipRange<span class="token punctuation">;</span><br><br>      <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">var</span> width <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>tooltip<span class="token punctuation">.</span>styleObj<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(calc(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x <span class="token operator">+</span><br>        width <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>dimensions<span class="token punctuation">.</span>margin<span class="token punctuation">.</span>left<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px), calc(-100% + </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px))</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>tooltip<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token function">handleMouseLeave</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>tooltip<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<pre class="language-css"><code class="language-css"><br><span class="token selector">.mean-text</span> <span class="token punctuation">{</span><br>  <span class="token property">fill</span><span class="token punctuation">:</span> maroon<span class="token punctuation">;</span><br>  <span class="token property">text-anchor</span><span class="token punctuation">:</span> middle<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token selector">.wrapper</span> <span class="token punctuation">{</span><br>  <span class="token comment">/* set position on the wrapper to accommodate tooltip position */</span><br>  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span><br>  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span><br>  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span><br>  <span class="token property">font-family</span><span class="token punctuation">:</span> sans-serif<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token selector">.bin rect</span> <span class="token punctuation">{</span><br>  <span class="token property">fill</span><span class="token punctuation">:</span> cornflowerblue<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token selector">.bin rect:hover</span> <span class="token punctuation">{</span><br>  <span class="token property">fill</span><span class="token punctuation">:</span> purple<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">.bin text</span> <span class="token punctuation">{</span><br>  <span class="token property">text-anchor</span><span class="token punctuation">:</span> middle<span class="token punctuation">;</span><br>  <span class="token property">fill</span><span class="token punctuation">:</span> darkgrey<span class="token punctuation">;</span><br>  <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span><br>  <span class="token property">font-family</span><span class="token punctuation">:</span> sans-serif<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">.mean</span> <span class="token punctuation">{</span><br>  <span class="token property">stroke</span><span class="token punctuation">:</span> maroon<span class="token punctuation">;</span><br>  <span class="token property">stroke-dasharray</span><span class="token punctuation">:</span> 2px 4px<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">.x-axis-label</span> <span class="token punctuation">{</span><br>  <span class="token property">fill</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span><br>  <span class="token property">font-size</span><span class="token punctuation">:</span> 1.4em<span class="token punctuation">;</span><br>  <span class="token property">text-transform</span><span class="token punctuation">:</span> capitalize<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">.tooltip</span> <span class="token punctuation">{</span><br>  <span class="token comment">/* opacity: 0; */</span><br>  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span><br>  <span class="token property">top</span><span class="token punctuation">:</span> -12px<span class="token punctuation">;</span><br>  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span><br>  <span class="token property">padding</span><span class="token punctuation">:</span> 0.6em 1em<span class="token punctuation">;</span><br>  <span class="token property">background</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span><br>  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span><br>  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ddd<span class="token punctuation">;</span><br>  <span class="token property">z-index</span><span class="token punctuation">:</span> 10<span class="token punctuation">;</span><br>  <span class="token property">transition</span><span class="token punctuation">:</span> all 0.2s ease-out<span class="token punctuation">;</span><br>  <span class="token property">pointer-events</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">.tooltip:before</span> <span class="token punctuation">{</span><br>  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span><br>  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span><br>  <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span><br>  <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span><br>  <span class="token property">width</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span><br>  <span class="token property">height</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span><br>  <span class="token property">background</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span><br>  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ddd<span class="token punctuation">;</span><br>  <span class="token property">border-top-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span><br>  <span class="token property">border-left-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span><br>  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> 50%<span class="token punctuation">)</span> <span class="token function">rotate</span><span class="token punctuation">(</span>45deg<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token property">transform-origin</span><span class="token punctuation">:</span> center center<span class="token punctuation">;</span><br>  <span class="token property">z-index</span><span class="token punctuation">:</span> 10<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">.tooltip-range</span> <span class="token punctuation">{</span><br>  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 0.2em<span class="token punctuation">;</span><br>  <span class="token property">font-weight</span><span class="token punctuation">:</span> 600<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>


<p><a href="/blog/">← Home</a></p>

    </main>

    <footer></footer>

    <!-- Current page: /blog/posts/june-11-2020/ -->
  </body>
</html>
